!function(a){"use strict";function b(b,c){a.extend(b,{action:"es_data_manager_get_list",data_manager_nonce:f.get_list}),c.addClass("es-preload"),a.get(ajaxurl,b,function(a){"success"===a.status&&c.html(a.content)},"json").always(function(){c.removeClass("es-preload").find("input").trigger("change")})}function c(b,c){a.extend(b,{action:"es_data_manager_get_form",data_manager_nonce:f.get_form}),c.addClass("es-preload"),a.get(ajaxurl,b,function(b){"success"===b.status&&(c.html(b.content),a([document.documentElement,document.body]).animate({scrollTop:c.offset().top-a(window).height()/2},500))},"json").always(function(){c.removeClass("es-preload").find("input").trigger("change")})}function d(b,c){a.extend(b,{action:"es_data_manager_get_creator",data_manager_nonce:f.get_creator}),c.find(".js-es-terms").addClass("es-preload"),a.get(ajaxurl,b,function(a){"success"===a.status&&c.replaceWith(a.content)},"json").always(function(){c.find(".js-es-terms").removeClass("es-preload").find("input").trigger("change")})}var e=Estatik_Data_Manager.tr,f=Estatik_Data_Manager.nonce;a(function(){if(a(document).on("keyup",".js-es-search-terms",function(){var b,c;b=a(this),c=b.val().toUpperCase(),b.closest(".js-es-terms-creator").find(".js-es-term").each(function(){var b=a(this);b.find(".es-term-label").html().toUpperCase().indexOf(c)>-1?b.removeClass("es-hidden"):b.addClass("es-hidden")})}),a(document).on("change",".js-es-location-dep-radio",function(){var b=a(this).data("config"),c=a(this).val();a(this).is(":checked")&&void 0!==b.dependencies&&b.dependencies.length&&b.dependencies.forEach(function(b){d({dep:b,parent_id:c,taxonomy:"es_location"},a("#es-terms-"+b+"-creator"))})}),a(document).on("change",".js-es-field--term .es-field__input",function(){var b=a(this),c=a(this).closest(".js-es-term"),d=c.closest("ul"),e=d.closest(".js-es-terms-creator"),f=e.find(".js-es-terms-selected-delete");b.is(":checked")?c.addClass("es-term--active"):c.removeClass("es-term--active"),d.find(".js-es-field--term .es-field__input:checked").length?f.removeClass("es-hidden"):f.addClass("es-hidden")}),a(document).on("change keyup",".js-es-term-name",function(){var b=a(this),c=a(this).closest("form").find("[type=submit]");b.val().trim().length?c.removeProp("disabled").removeAttr("disabled"):c.prop("disabled","disabled")}).trigger("change"),a(document).on("submit",".js-es-term-form",function(){var b=a(this),d=b.find(".js-es-term-name"),e=b.closest(".js-es-terms-creator").find(".js-es-terms"),f=b.find("input,button"),g=b.serialize();return f.prop("disabled","disabled"),a.post(ajaxurl,g,function(f){"success"===f.status&&(f.is_new?(e.append(f.content),d.val("")):(c({taxonomy:f.taxonomy},b.closest(".js-es-terms-creator__form")),a(".es-"+f.taxonomy+"-term-"+f.term_id).replaceWith(f.content))),"error"===f.status&&f.message&&Estatik_Admin.renderNotification(f.message)},"json").fail(function(){Estatik_Admin.renderNotification("<div class='es-notification es-notification--error'>Saving error. Please, contact estatik support.</div>")}).always(function(){f.removeProp("disabled").removeAttr("disabled").trigger("change")}),!1}),a(document).on("click",".js-es-term__delete--confirm, .js-es-terms-selected-delete",function(b){var c=a(this).data("message"),d=[],f=a(b.currentTarget),g=f.data("taxonomy");if(f.hasClass("js-es-terms-selected-delete")){var h=a(this).closest(".js-es-terms-creator").find(".js-es-term input:checked");c=c.replace("%d",h.length),h.each(function(){d.push(a(this).val())})}else d.push(a(this).data("term"));return a.estatikPopup({inline_html:"<p class='es-center es-popup-text'>"+c+"</p><div class='es-popup__buttons es-center'><button class='js-es-popup__close es-btn es-btn es-btn--link'>"+e.cancel+"</button><button class='js-es-delete-terms es-btn es-btn--secondary' data-taxonomy='"+g+"' data-terms='"+JSON.stringify(Object.assign({},d))+"'>"+e.remove+"</button></div>"}).open(),!1}),a(document).on("click",".js-es-delete-terms",function(){var c=a(this).data("terms"),d=a(this).data("taxonomy"),e={terms_ids:c,action:"es_data_manager_delete_terms",data_manager_nonce:f.delete_terms,taxonomy:d};return a.post(ajaxurl,e,function(e){e=e||{},"success"===e.status&&("es_location"===d?(void 0!==e.children_terms_deleted&&e.children_terms_deleted.length&&e.children_terms_deleted.forEach(function(b){a(".js-es-term-"+b).remove()}),Object.values(c).forEach(function(b){var c=a(".js-es-term-"+b);c.closest(".js-es-terms-creator").find(".js-es-terms-selected-delete").addClass("es-hidden"),c.remove()})):b({taxonomy:d},a("#es-terms-"+d+"-creator").find(".js-es-terms")))},"json").fail(function(){}).always(function(){a.estatikPopup().close()}),!1}),a(document).on("click",".js-es-term__edit",function(b){var d=a(this);return c(d.data(),d.closest(".js-es-terms-creator").find(".js-es-terms-creator__form")),!1}),a(document).on("click",".js-es-term__restore",function(){var c=a(this).closest(".js-es-terms"),d=a(this).data();a.extend(d,{data_manager_nonce:f.restore_term,action:"es_data_manager_restore_term"}),c.addClass("es-preload"),a.post(ajaxurl,d,function(a){"success"===a.status&&b({taxonomy:d.taxonomy},c)},"json")}),a(document).on("change",".es-field__is_terms_icons_enabled .es-field__input",function(){a(".es-field__term_icon_type input.es-field__input:checked").trigger("change")}),a(document).on("change",".es-field__term_icon_type .es-field__input",function(){var b=(a(this),a(".es-field__is_terms_icons_enabled .es-field__input").is(":checked")),c=b?a(".es-field__term_icon_type input:checked").val():"simple";["es_feature","es_amenity"].forEach(function(b){var d=a("#es-terms-"+b+"-creator"),e=d.find(".js-es-terms");e.addClass("es-preload"),Estatik_Admin.loadTermsCreator(b,c,function(a){d.replaceWith(a)}).always(function(){e.removeClass("es-preload")})})}),a(".js-es-currency").on("change",function(){var b=a(this).val();a(".js-es-sign").val(b).trigger("change")}),a(".js-es-sign").on("change",function(){var b=a(this).find("option:selected").text();b=a(this).val()?b:a(".js-es-currency option:selected").attr("value"),a(".js-es-append-sign option").each(function(){var c=a(this),d=a(this).parent();c.html(d.data(c.attr("value")).replace("{sign}",b))})}),a(document).on("change",".js-es-default-currency",function(){a(this).closest("table").find(".js-es-default-currency:not([id="+a(this).attr("id")+"])").removeProp("checked").removeAttr("disabled")}),a(document).on("click",".js-es-data-manager-nav a",function(){a(".js-es-data-manager-nav").find("li").removeClass("active"),a(this).closest("li").addClass("active");var b=a(a(this).attr("href")),c=b.closest(".js-es-data-manager__inner");if(c.length){c.closest(".es-content").find(".js-es-data-manager__inner").addClass("es-hidden"),c.removeClass("es-hidden");var d=b.offset().top-122;a([document.documentElement,document.body]).stop().animate({scrollTop:d>=0?d:0},500)}return!1}),window.location.hash){var g=a('a[href="'+window.location.hash+'"]');g.length&&g.trigger("click")}else a(".js-es-data-manager-nav:first-child li:first-child a").trigger("click")})}(jQuery);